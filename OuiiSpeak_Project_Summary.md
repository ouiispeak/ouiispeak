## OuiiSpeak – Project Checkup (Next.js App Router)

### Frameworks, libraries, and key dependencies
- **Next.js**: 15.5.5
- **React**: 19.1.0, **React DOM**: 19.1.0
- **Supabase**: `@supabase/supabase-js` ^2.75.0
- **Supabase Auth Helpers (Next.js)**: `@supabase/auth-helpers-nextjs` ^0.10.0
- **ESLint**: ^9 with `eslint-config-next` 15.5.5
- **TypeScript**: ^5
- **Tailwind CSS v4**: `tailwindcss` ^4 with `@tailwindcss/postcss` ^4

### Integrations configured
- **Supabase**
  - Client-side SDK initialized in `src/lib/supabaseClient.ts` using `NEXT_PUBLIC_SUPABASE_URL` and `NEXT_PUBLIC_SUPABASE_ANON_KEY`.
  - Server-side client factory in `src/lib/supabaseServer.ts` using `createServerComponentClient({ cookies })` from `@supabase/auth-helpers-nextjs` for SSR session access.
  - `middleware.ts` exports `updateSession` from `@supabase/auth-helpers-nextjs` to keep auth cookies in sync across navigation and refreshes.
- **Tailwind CSS v4**
  - Enabled via `postcss.config.mjs` with `@tailwindcss/postcss` plugin.
  - `src/app/globals.css` imports `tailwindcss` and defines theme tokens using the new v4 `@theme` directive.

### Environment variables detected
- Referenced in code:
  - `NEXT_PUBLIC_SUPABASE_URL`
  - `NEXT_PUBLIC_SUPABASE_ANON_KEY`
- `.env.local` was not found in the repository root during this scan. Ensure it contains values:
  - `NEXT_PUBLIC_SUPABASE_URL=...`
  - `NEXT_PUBLIC_SUPABASE_ANON_KEY=...`

### Folder structure overview (key paths)
- `src/app/`
  - `layout.tsx` – Root layout and metadata.
  - `page.tsx` – Home page with links to `/auth` and `/profile` and `SupabasePing` status.
  - `auth/page.tsx` – Auth screen rendering `AuthForm` (client component).
  - `profile/page.tsx` – Server-protected profile page that redirects to `/auth` when unauthenticated, renders `ProfileForm` (client).
  - `globals.css` – Tailwind v4 setup and theme tokens.
- `src/components/`
  - `AuthForm.tsx` – Client-side email/password login and signup with Supabase and client-side redirect to `/profile`.
  - `ProfileForm.tsx` – Client-side profile upsert/fetch/edit flow for `profiles` table; also performs safety net redirect if no session.
  - `SupabasePing.tsx` – Client-side connectivity/session check display.
- `src/lib/`
  - `supabaseClient.ts` – Browser Supabase client using public envs.
  - `supabaseServer.ts` – `createServerSupabase()` for SSR using cookies.
- `middleware.ts` – Exposes `updateSession` to persist auth across navigation.

### Pages, components, and main logic flow
- **Home (`/`)**
  - Shows Tailwind-styled header and `SupabasePing` to indicate connectivity and session presence.
  - Links to `/auth` and `/profile`.
- **Auth (`/auth`)**
  - `AuthForm` handles sign-in and sign-up via Supabase email/password.
  - If already authenticated, shows current email, buttons to go to profile or sign out.
  - On successful auth, client-side redirect to `/profile`.
- **Profile (`/profile`)**
  - Server-side: `createServerSupabase()` fetches session during RSC render. If no session, immediate `redirect('/auth')`.
  - Client-side: `ProfileForm` loads current session again, ensures a `profiles` row exists, fetches `id, email, full_name`, and allows editing `full_name`.

### Current functionality working correctly
- SSR-aware session check and redirect on `/profile` using `@supabase/auth-helpers-nextjs` with cookies.
- Client-side auth flows (login, signup, signout) via `@supabase/supabase-js`.
- Tailwind v4 styles loaded via PostCSS; basic themed colors applied.
- Middleware `updateSession` present, enabling cookie persistence for sessions.

### TODOs and incomplete items
- Ensure the dependency `@supabase/auth-helpers-nextjs` is installed locally (package.json lists it).
- Provide `.env.local` with valid `NEXT_PUBLIC_SUPABASE_URL` and `NEXT_PUBLIC_SUPABASE_ANON_KEY`.
- Optionally add server-side data fetching for profile details to hydrate client faster (currently fetched client-side only).
- Consider adding protected API routes or server actions using `createServerSupabase()` as needed.

### Known warnings, build errors, or missing values
- No linter errors detected on recently edited files.
- `.env.local` missing or not found in workspace; without values, Supabase initialization will fail at runtime.
- If `middleware.ts` is added, the dev server may require restart for Next.js to pick it up.

### Versions (from package.json)
```json
{
  "next": "15.5.5",
  "react": "19.1.0",
  "react-dom": "19.1.0",
  "@supabase/supabase-js": "^2.75.0",
  "@supabase/auth-helpers-nextjs": "^0.10.0",
  "eslint": "^9",
  "eslint-config-next": "15.5.5",
  "typescript": "^5",
  "tailwindcss": "^4",
  "@tailwindcss/postcss": "^4"
}
```

---
Generated by project scan at build time. Update this file whenever dependencies or app structure change.

